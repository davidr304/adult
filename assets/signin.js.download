let likedVideosSignUpFlag=!1;function userClogTracking(e,i,t,n,o,s){let a=o?"&origin_item_id="+o:"",r=n?"&origin_url="+encodeURIComponent(n):"",c=n?"&origin="+t:"",l=s?"&origin_item_variation="+s:"",d="";void 0!==page_params["geo-localization"]&&"all"!==page_params["geo-localization"]&&(d="&geo-localization="+page_params["geo-localization"]);var g="";if(void 0!==page_params&&page_params.subdomain&&"signup-open"==i)switch(page_params.subdomain){case"es":g="&geo-localization=spanish";break;case"jp":g="&geo-location=japan";break;case"it":g="&geo-location=italy";break;case"fr":g="&geo-location=france";break;default:g=""}o=e+"/_i?type=event&event="+i+c+r+a+l+d+g,n="undefined"!=typeof liuIdOrNull&&liuIdOrNull?{__m:liuIdOrNull}:{};fetch(o,{method:"POST",headers:n}).then(e=>{if(!e.ok)throw new Error("Network response was not ok")}).catch(e=>{console.log("Fetch error occurred:",e)})}var extendedPropsForModal={signInUtilModal:null,config:TOP_BODY,show:function(e){e=void 0!==e?e:{},"undefined"!=typeof event&&event.preventDefault(),this.options=e;var i,t,n=document.getElementById("signinModal");if(navigator.userAgent&&navigator.userAgent.match(/PLAYSTATION/))return document.location.assign("http://"+location.hostname+"/login"),!1;"block"===n.style.display&&1!=this.config.shorties||(t=!!(i=document.getElementById("rightMenu"))&&i.querySelector(".closeHamMenu"),i&&i.classList.contains("active")&&t&&t.click(),this._openModal(e,n))},_openModal:function(n,e){e&&(this.signInUtilModal=new MG_Modal({content:e,className:"loginModal"}),this.signInUtilModal)&&(this.newInstance=!1,this.signInUtilModal.openModal((e,i)=>{var t;this.container=i,this._toggleModalContent(this.container,n),n.subscribe&&(i=this.container.querySelector(".js-loginForm"),(t=document.createElement("input")).type="hidden",t.name="subscribe",t.value=1,i.appendChild(t)),n.shortiesInputVideoId&&(i=this.container.querySelector(".js-loginForm"),(t=document.createElement("input")).type="hidden",t.name="videoId",t.value=n.shortiesInputVideoId,i.appendChild(t)),this.init(),this.showCaptcha&&(this._initializeCaptcha(),this.toggleButtonDisable(!0)),this.newInstance=!0}),document.querySelectorAll(".js_closeModal").forEach(e=>{e.addEventListener("click",()=>{this.signInUtilModal.closeModal(),this.recaptchaCompleted=!1,this.container=null})}),e=document.getElementById("mobileContainer"),this.container.parentElement.addEventListener(e?"touchstart":"mousedown",function(e){e=e.target;e&&"signUp"===n.step&&("modalWrapMTubes"===e.getAttribute("id")?userClogTracking(currentDomain,"signup-aborted",originPart,originUrl,"outside_modal_window",newModal):e.classList.contains("closeMTubes")&&userClogTracking(currentDomain,"signup-aborted",originPart,originUrl,"button-close-x",newModal))}),document.querySelector(".closeMTubes").addEventListener("click",()=>{likedVideosSignUpFlag=!1}),this.newInstance||this._toggleModalContent(this.container,n))},_toggleModalContent:function(t,n){var o=t.querySelector(".signInWrap"),s=t.querySelector(".signUpWrap");if(o&&s)if("signUpVideoLikedWatchPage"===n.step&&(likedVideosSignUpFlag=!0),"signIn"===n.step||void 0===n.step)this._resetForms(o),s.classList.add("displayNone"),o.classList.remove("displayNone"),"undefined"!=typeof phCustomEvent&&phCustomEvent.dispatch("initSignUp",!1);else if("signUp"===n.step||"signUpLikedVideo"===n.step||"signUpVideoLikedWatchPage"===n.step){let e="undefined",i="";window.dataLayer.forEach(function(e){"video_player"===e.event&&(i=e.event_label)}),"signUpLikedVideo"===n.step?e="liked_videos_page_cta":"signUpVideoLikedWatchPage"===n.step&&likedVideosSignUpFlag?e="liked_videos_snackbar":!i||"favorite"!==i&&"subscribe"!==i||(e="player_"+i),window.dataLayer.push({event:"signup_impression",location:e}),s.classList.remove("displayNone"),o.classList.add("displayNone"),t.classList.add("updatedModal"),"undefined"!=typeof phCustomEvent&&phCustomEvent.dispatch("initSignUp",!0)}},_resetForms:function(e){var i,t,n=e.getAttribute("data-step");n&&"signIn"===n&&(n=e.querySelector("form"),i=e.querySelector("#signinSubmit"),t=e.querySelector(".signinError"),e=e.querySelectorAll("input"),n&&n.reset(),i&&i.setAttribute("disabled","disabled"),i?.classList.add("disabled"),e?.forEach(e=>e.classList.remove("signin_error")),t)&&(t.innerText="")},_initializeCaptcha:function(){try{var e=this.container.querySelector(".g-recaptcha");null!=typeof CaptachaComponents&&e&&CaptachaComponents.registerComponent(e,this.captchaAcknowledgement)}catch(e){}},redirectFromResponse:function(e){var i=this.container.querySelector("#signinLoggingin"),t=this.container.querySelector(".js-signinUsername"),n=this.container.querySelector(".js-signinPassword"),o=document.querySelectorAll(".ph-icon-error"),s=this.container.querySelector(".signinError");e.redirect?(i.style.display="block",s.style.display="none",t.classList.remove("signin_error"),n.classList.remove("signin_error"),o?.forEach(e=>!e.classList.contains("displayNone")&&e.classList.add("displayNone")),void 0!==e.subscribe&&1==e.subscribe?document.querySelector(".subscribeButton button.login").setAttribute("data-login","0"):this.options.callbackCustomRedirect&&"function"==typeof this.options.callbackCustomRedirect?this.options.callbackCustomRedirect(e):document.location.assign(e.redirect)):(s.style.display="block",s.innerHTML=e.message,t.classList.add("signin_error"),n.classList.add("signin_error"),o?.forEach(e=>e.classList.contains("displayNone")&&e.classList.remove("displayNone")),this.toggleButtonDisable(!1))},callbackSuccess:function(e){if("0"==e.premium_redirect_cookie||e.forceRedirect){if(e.showExpiredFreeTrial)return this.premiumModalFromResponse(e);this.redirectFromResponse(e)}else{e=new Date,e=premiumRedirectCookieURL+(0<premiumRedirectCookieURL.indexOf("?")?"&":"?")+"timestamp="+e.getTime();fetch(e,{method:"GET",credentials:"include"}).then(e=>{if(e.ok)return e.json();throw new Error("Network response was not ok")}).then(e=>{var i=this.container.querySelector("#signinLoggingin"),t=this.container.querySelector(".signinError");e.redirect?(i.style.display="",t.style.display="none",document.location.assign(e.redirect)):(t.style.display="",t.innerHTML=e.message,this.toggleButtonDisable(!1))}).catch(e=>{console.error("Fetch error:",e)})}},loginAjaxSuccess:function(e){var i;e.twoStepVerification?(i=this.container.querySelector(".js-loginForm"))&&(i.classList.add("displayNone"),this.setupTwoStepVerification(e)):e.requireCaptcha?(this.showCaptcha=!0,(i=document.querySelector(".js-loginForm .signinError"))&&(i.style.display="block",i.innerHTML=e.message),this.setupCaptacha()):this.callbackSuccess(e)},initGoogleSso:function(){var e=document.getElementsByTagName("head")[0],i=document.createElement("script"),t=(i.type="text/javascript",i.src="https://accounts.google.com/gsi/client",e.appendChild(i),this);i.onload=function(){google.accounts.oauth2.initTokenClient({client_id:gSSOClientId,scope:"https://www.googleapis.com/auth/userinfo.email",ux_mode:"popup",callback:e=>{t.loginAjax(e.access_token,".loginModal form.js-loginForm")}}).requestAccessToken()}}},signinbox=Object.assign({},Signinbox,extendedPropsForModal);if("complete"===document.readyState||"interactive"===document.readyState){document.location.search.match(/showSigninBox=true/i)&&null!=document.getElementById("headerLoginLink")&&signinbox.show(),document.addEventListener("click",function(){document.querySelector(".isOpenMTubes")||(likedVideosSignUpFlag=!1)});let e=document.getElementById("headerLoginLink"),t=document.querySelector(".profileOptions");if(e&&e.addEventListener("click",function(){t&&(t.classList.contains("show")?t.classList.remove("show"):(t.classList.add("show"),userClogTracking(currentDomain,"user-menu",originPart,originUrl,"user-menu-icon",newModal)))}),document.addEventListener("click",function(e){var i=e.target;e&&i&&"headerLoginLink"!==i.id&&!i.classList.contains("selectMenu")&&t&&t.classList.remove("show"),(i.classList.contains("closeMTubes")||i.classList.contains("isVisibleMTubes"))&&"undefined"!=typeof sessionStorage&&null!==sessionStorage.getItem("notLoggedIn")&&sessionStorage.removeItem("notLoggedIn")}),"undefined"!=typeof openSigninModal&&"undefined"!=typeof signinModalMessage&&openSigninModal){signinbox.show({step:"signIn"});let e=signinbox.container.querySelector(".signinError");e&&(e.style.display="block",e.innerHTML=signinModalMessage??"")}document.addEventListener("click",e=>{e.target.matches("#ssoGoogleSigninButton")&&signinbox.initGoogleSso()})}